#!/usr/bin/env ruby

require "rubygems"

gems_dir = File.join(File.dirname(__FILE__), '..', 'gems')

if File.directory?(gems_dir)
  $BUNDLE = true
  Gem.clear_paths
  Gem.path.replace([File.expand_path(gems_dir)])
  ENV["PATH"] = "#{File.dirname(__FILE__)}:#{ENV["PATH"]}"
  
  gem_file = File.join(gems_dir, "specifications", "cucumber-*.gemspec")
  
  if local_gem = Dir[gem_file].last
    version = File.basename(local_gem)[/-([\.\d]+)\.gemspec$/, 1]
  end
end

version ||= ">= 0"

if ARGV.first =~ /^_(.*)_$/ and Gem::Version.correct? $1 then
  version = $1
  ARGV.shift
end

gem 'cucumber', version
load 'cucumber'
